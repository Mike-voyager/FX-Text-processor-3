"""
Hardware control commands for Epson FX-890.

Contains hardware-related ESC/P commands: printer initialization, reset, beep,
(practically no auto-cutter on base FX-890), online/offline control, etc.
All commands verified for FX-890.

Reference: Epson FX-890 Technical Reference Manual, Chapter 10, Appendix F.
Compatibility: FX-890, FX-2190, LX-300+II

IMPORTANT: Только команды, подтверждённые официальной документацией FX-890.
           Не включены ESC/P 2, не подтверждённые или специфические опции.
"""

from typing import Final

__all__ = [
    "ESC_INIT_PRINTER",
    "ESC_BEEP",
    "ESC_ONLINE",
    "ESC_OFFLINE",
]

# =============================================================================
# PRINTER CONTROL
# =============================================================================

ESC_INIT_PRINTER: Final[bytes] = b"\x1b@"
"""
Инициализация принтера (software reset).

Command: ESC @
Hex: 1B 40
Effect: Приводит принтер к состоянию после включения питания.
Resets:
    - Все режимы форматирования (bold, underline, ширина, шрифты и т.д.)
    - Интернациональный набор символов, таблица знаков
    - Табуляторы, отступы, ширина/длина страницы,
    - Стирает печатный буфер

Использование:
    - Перед началом нового документа
    - После сбоя или для сброса параметров

Пример:
    >>> printer.send(ESC_INIT_PRINTER)
    >>> printer.send(b"Печать с дефолтными настройками\\r\\n")

Подтверждено: ✅ FX-890 User's/Technical Guide
"""

ESC_BEEP: Final[bytes] = b"\x07"
"""
Сигнал "beep" (bell).

Command: BEL (ASCII 07h)
Hex: 07
Effect: Контрольный звук принтера ("писк"), если функция поддерживается.

Заметки:
    - Может не поддерживаться на всех FX-890 (особ. если отключён DIP/EEPROM опциями)
    - Может использоваться для уведомления пользователя, или сигнала о завершении задания

Пример:
    >>> printer.send(b"Печать завершена\\r\\n")
    >>> printer.send(ESC_BEEP)

Подтверждено: ✅ Стандарт ASCII/Epson ESC/P, обычно поддерживается
"""

ESC_ONLINE: Final[bytes] = b"\x11"
"""
Перевести принтер в online-режим (готов к печати).

Command: DC1 (Device Control 1)
Hex: 11
Effect: Возвращает принтер в рабочее состояние после offline (некоторые модели).

Заметки:
    - На большинстве FX-серии (включая FX-890) перевод online через панель, DC1 нужен редко.
    - Поддержка зависит от состояния панели и драйвера, часто работает только через параллельный порт/LPT.

Пример:
    >>> printer.send(ESC_ONLINE)
    >>> printer.send(b"Печать продолжена\\r\\n")

Подтверждено: ⚠️ Стандарт ASCII/ESC/P, не всегда поддерживается в USB-режиме
"""

ESC_OFFLINE: Final[bytes] = b"\x13"
"""
Перевести принтер в offline-режим (паузу).

Command: DC3 (Device Control 3)
Hex: 13
Effect: Переводит устройство в "пауза/offline", если поддерживается.

Заметки:
    - Для временной остановки печати, например, перед сменой бумаги, ленты и т.д.
    - Управление через DC3 актуально в основном через физический LPT, а не через USB.

Пример:
    >>> printer.send(ESC_OFFLINE)
    >>> # ...заменить бумагу, затем...
    >>> printer.send(ESC_ONLINE)

Подтверждено: ⚠️ Стандарт ASCII/ESC/P, не всегда поддерживается в USB-режиме
"""

# =============================================================================
# НЕ ВКЛЮЧЕНО — Опциональный paper cutter (ESC V)!
# =============================================================================

"""
ESC_CUT_PAPER (ESC V), а также другие специализированные hardware-команды
(например, автоподача бумаги, status request, кодировка состояния панели)
НЕ включены, потому что:
    - FX-890 не имеет штатного авто-резака
    - FX-890 не поддерживает ESC V без опционального блока (и даже с ним почти не используется)

Для операций с бумагой используйте форм-фид (FF), смену ленты, проверку через built-in индикаторы или USB/printer driver диалоги.
"""

# =============================================================================
# Usage examples и troubleshooting
# =============================================================================

"""
ПРИМЕРЫ ВЫЗОВОВ:

# Сбросить все форматирования и напечатать в дефолтном режиме:
printer.send(ESC_INIT_PRINTER)
printer.send(b"Новый документ\\r\\n")

# Сигнал завершения задачи:
printer.send(ESC_BEEP)

# Временная остановка, потом возобновить (если поддерживается протоколом):
printer.send(ESC_OFFLINE)
# ...ожидание...
printer.send(ESC_ONLINE)
printer.send(b"Продолжаем печать!")

# Диагностика:
Если ESC_INIT_PRINTER не приводит к ожидаемому сбросу:
    - Возможно, аппаратная проблема или команда блокируется драйвером
    - Проверьте подключение, панель статуса принтера

Если ESC_BEEP не издает звука:
    - Проверьте наличие пьезо (у некоторых версий звук отсутствует)
    - Проверьте DIP/EEPROM-настройки
    - Тест с батарейкой или командой из DOS может прояснить вопрос

Если DC1/DC3 не срабатывает:
    - Через USB-порт управление онлайн-статусом может не поддерживаться
    - Работает только через LPT/COM, либо в DOS/BIOS mode
    - На новых системах используйте меню панели принтера

P.S. Для физического контроля бумаги используйте Form Feed (FF), а не ESC V!
"""
